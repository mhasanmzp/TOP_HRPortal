<ion-header style="margin-bottom: 50px;">
  <ion-toolbar>
    <ion-title>Goods Received Note</ion-title>
    <ion-buttons slot="end">
      <ion-button (click)="openAddMaterialModal()">
        <ion-icon slot="start" name="add-circle-outline"></ion-icon>
        Add Asset
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content>
  <ion-grid>
    <!-- Search bar -->
    <ion-row>
      <ion-col size="12">
        <ion-searchbar [(ngModel)]="searchTerm" placeholder="Search by Model or Serial Number"></ion-searchbar>
      </ion-col>
    </ion-row>
    <!-- Table headers -->
    <ion-row class="table-header">
      <ion-col class="tg-hpky" style="width: 50px; margin-left: 50px;">Purchase Id</ion-col>
      <ion-col class="tg-hpky" style="width: 170px;">
        Category&nbsp;&nbsp;&nbsp;
        <ion-icon style="font-size: 14px;" name="filter-outline"></ion-icon>
      </ion-col>
      <ion-col class="tg-hpky" style="width: 300px;">Product Name</ion-col>
      <ion-col class="tg-hpky" style="width: 120px;">
        Received Quantity&nbsp;&nbsp;&nbsp;
      </ion-col>
      <ion-col class="tg-hpky" style="width: 170px;">Quantity Rejected</ion-col>
      <ion-col class="tg-hpky" style="width: 170px;">Stockable Quantity</ion-col>
    </ion-row>
    <!-- Data rows -->
    <ion-row *ngFor="let item of purchaseData; let i = index" [ngClass]="{'data-row-even': i % 2 === 0, 'data-row-odd': i % 2 !== 0}">
      <ion-col style="width: 50px; margin-left: 40px;">{{ item.purchaseId }}</ion-col>
      <ion-col style="width: 170px; margin-left: 30px;">{{ item.categoryName }}</ion-col>
      <ion-col style="width: 300px; margin-left: 30px;">{{ item.productName }}</ion-col>
      <ion-col style="width: 120px; margin-left: 50px;">{{ item.totalItems }}</ion-col>
      <ion-col style="width: 170px; margin-left: 40px;">{{ item.quantityRejected }}</ion-col>
      <ion-col style="width: 170px; margin-right: -40px;">{{ item.stockableQuantity }}</ion-col>
    </ion-row>
  </ion-grid>

  <ion-modal [isOpen]="isModalOpen" (didDismiss)="closeAddMaterialModal()">
    <ng-template>
      <ion-header>
        <ion-toolbar>
          <ion-title>Add Asset</ion-title>
          <ion-buttons slot="end">
            <ion-button (click)="closeAddMaterialModal()">
              <ion-icon slot="icon-only" name="close-outline"></ion-icon>
            </ion-button>
          </ion-buttons>
        </ion-toolbar>
      </ion-header>
      <ion-content>
        <form (ngSubmit)="saveMaterial()">
          <ion-grid>
            <!-- Form fields -->
            <!-- Row 1: OEM and Project Name -->
            <ion-row>
              <ion-col size="6">
                <ion-item>
                  <ion-label position="stacked">OEM</ion-label>
                  <ion-select  placeholder="Select OEM" required>
                    <ion-select-option *ngFor="let oem of data" [value]="oem.oemId">{{ oem.oemName }}</ion-select-option>
                  </ion-select>
                </ion-item>               
              </ion-col>
              <ion-col size="6">
                <ion-item>
                  <ion-label position="stacked">Project Name</ion-label>
                  <ion-input [(ngModel)]="material.projectName" name="projectName" class="small-input" required></ion-input>
                </ion-item>
              </ion-col>
            </ion-row>
            <!-- Row 2: Category and Model -->
            <ion-row>
              <ion-col size="6">
                <ion-item>
                  <ion-label position="stacked">Category</ion-label>
                  <ion-select  placeholder="Select Category" required>
                    <ion-select-option *ngFor="let category of categories" [value]="category.id">{{ category.name }}</ion-select-option>
                  </ion-select>
                </ion-item>
              </ion-col>
              <ion-col size="6">
                <ion-item>
                  <ion-label position="stacked">Product Name</ion-label>
                  <ion-input [(ngModel)]="material.model" name="productName" class="small-input" required></ion-input>
                </ion-item>
              </ion-col>
            </ion-row>
            <!-- Row 3: Quantity and Unit -->
            <ion-row>
              <ion-col size="6">
                <ion-item>
                  <ion-label position="stacked">Quantity</ion-label>
                  <ion-input type="number" [(ngModel)]="material.quantity" name="quantity" class="small-input" required></ion-input>
                </ion-item>
              </ion-col>
              <ion-col size="6">
                <ion-item>
                  <ion-label position="stacked">Unit</ion-label>
                  <ion-select interface="popover" placeholder="Select Unit" [(ngModel)]="material.unit" name="unit" class="small-input" required>
                    <ion-select-option value="KG">KG</ion-select-option>
                    <ion-select-option value="Metre">Metre</ion-select-option>
                    <ion-select-option value="Units">Units</ion-select-option>
                    <ion-select-option value="Grams">Grams</ion-select-option>
                    <ion-select-option value="Pieces">Pieces</ion-select-option>
                    <ion-select-option value="Dozen">Dozen</ion-select-option>
                    <ion-select-option value="Bag">Bag</ion-select-option>
                    <ion-select-option value="Box">Box</ion-select-option>
                  </ion-select>
                </ion-item>
              </ion-col>
            </ion-row>
            <!-- Row 4: Date and Warranty Period -->
            <ion-row>
              <ion-col size="6">
                <ion-item>
                  <ion-label position="stacked">Date</ion-label>
                  <ion-input type="date" [(ngModel)]="material.date" name="date" class="small-input" required></ion-input>
                </ion-item>
              </ion-col>
              <ion-col size="6">
                <ion-item>
                  <ion-label position="stacked">Warranty Period (Months)</ion-label>
                  <ion-input type="number" [(ngModel)]="material.warrantyPeriod" name="warrantyPeriod" class="small-input" required></ion-input>
                </ion-item>
              </ion-col>
            </ion-row>
            <!-- Row 5: Serial Numbers -->
            <ion-row *ngIf="material.quantity && material.unit">
              <ion-col size="12">
                <!-- Heading for serial numbers -->
                <ion-item lines="none">
                  <ion-label position="stacked">Serial Numbers</ion-label>
                </ion-item>
                <!-- Serial number input boxes -->
                <ion-item *ngFor="let serial of getSerialNumbersArray(); let i = index">
                  <ion-label position="stacked">S.No: {{i+1}}</ion-label>
                  <ion-input [(ngModel)]="material.serialNumbers[i]" name="serialNumber{{ i }}" class="small-input" required></ion-input>
                </ion-item>
              </ion-col>
            </ion-row>
            <!-- Save Button -->
            <ion-row>
              <ion-col>
                <ion-button expand="block" type="submit" class="save-button">Save</ion-button>
              </ion-col>
            </ion-row>
          </ion-grid>
        </form>
      </ion-content>
    </ng-template>
  </ion-modal>
</ion-content>
